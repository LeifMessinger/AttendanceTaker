{% include "cssVariables.html" %}
<!DOCTYPE html>
<html lang="en">
{% load static %}
<head>
	<link rel="stylesheet" href="{% static 'AttendanceTaker/FlexML/FlexML.css' %}" type="text/css">
</head>
<style>
	body {
		display: flex;
		flex-direction: column;

		font-family: var(--font-family-thicc);
		font-size: calc(1vw + 1em);
	}
	.header{
	background-color: var(--main-bg-color);
    width: 100%;
    padding: 18px ;
    z-index: 100;
    box-shadow: 0px 5px 10px  rgba(0, 0, 0, 0.50);
    color: #fff;
	text-indent: 30px;
    text-decoration: none;
    letter-spacing: 2px;
    font-weight: 500;
	}
	.common_div{
		display: flex;
		flex-direction: row;
		justify-content: space-evenly;
		align-items: center;
		width: 100%;
		height: 90%;
		margin: auto;
	}
	.left_div{
		width: 50%;
		height: 70%;
		display: flex;
		flex-direction: column;
		align-items: center;
		justify-content: space-around;
		padding: 5px 0px;
	}
	.left_div_head{
        color: var(--dark-text-color);
	}
	.left_div_para{
		font-family: var(--font-family);
		text-align: justify;
		color: var(--dark-text-color);
	}
	.left_div_buttons{
		display: flex;
		flex-direction: row;
		flex-wrap: wrap;
		width: 100%;
		align-items: center;
		justify-content:space-around;
	}
	.right_div{
        width: 30%;
	}
	.input_form{
		    width: 100%;
			display: flex;
			flex-direction: column;
			align-items: center;
			padding:10% 0%;
            border-radius: 10px;
            background: var(--main-bg-color);
		}
		button, .ref_buttons {
            border-style: none;
            cursor: pointer;
            text-decoration: none;
            font-weight: 500;
            border-radius: 5px;
            text-align: center;
            text-decoration: none;
			transition-duration: 0.2s;
        }
		.ref_buttons:hover{
			transform: scale(1.1, 1.1);
		}
		button{
			padding:12px 18px;
			background-color: #ECEFF3;
			color: var(--dark-text-color);
		}
		.ref_buttons{
			width: 30%;
			padding:10px;
            background-color: var(--main-bg-color);
			color: #ECEFF3;
		} 
		.sec_btn{
			margin-left: 2%;
		}
		.create_room{
			font-weight: 700;
		}
</style>
    <div class="header">Attendance Taker</div>
	<div class="common_div">
		<div class="left_div">
			<div class="left_div_head">
			<h1>Attendance Taker {{ attendanceTakerVersion }}</h1>
		</div>
			<div class="left_div_buttons">
			<a class="ref_buttons" href="{% url 'verifyReceipt' %}">Receipt Verifier</a>	
			<a href="javascript:(function()%7B(async%20function()%7B%0A%20%20%2F%2FSo%20we'll%20just%20wait%2010%20seconds%0A%20%20async%20function%20wait(ms%2C%20retVal)%7B%0A%20%20%20%20%20%20return%20new%20Promise((resolve%2C%20reject)%3D%3E%7B%0A%20%20%20%20%20%20%20%20%20%20setTimeout(resolve%2C%20ms%2C%20retVal)%3B%0A%20%20%20%20%20%20%7D)%3B%0A%20%20%7D%0A%0A%20%20let%20roleSelect%20%3D%20document.querySelector('select%5Bname%3D%22enrollment_role_id%22%5D')%3B%0A%20%20%2F%2FFor%20each%20of%20the%20options%20in%20the%20drop%20down%0A%20%20for(let%20child%20of%20Array.from(roleSelect.children))%7B%0A%20%20%20%20%20%20if(child.textContent.trim().includes(%22Student%20(%22))%7B%20%2F%2FBecause%20there's%20%22Student%20Leader%22%20with%20no%20students%0A%20%20%20%20%20%20%20%20%20%20roleSelect.value%20%3D%20child.getAttribute(%22value%22)%3B%0A%20%20%20%20%20%20%20%20%20%20roleSelect.dispatchEvent(new%20Event(%22change%22))%3B%0A%20%20%20%20%20%20%7D%0A%20%20%7D%0A%0A%20%20await%20wait(1000)%3B%0A%0A%20%20let%20scrollIntervalId%20%3D%20setInterval(function()%7B%0A%20%20%20%20%20window.scrollBy(0%2C%2010000)%0A%20%20%7D%2C%201000)%3B%0A%0A%20%20%2F%2FThis%20isn't%20reliable%2C%20because%20the%20loading%20sign%20only%20shows%20when%20it's%20fetching%20more%20results.%0A%20%20function%20isLoading()%7B%0A%20%20%20%20return%20(document.querySelector(%22.paginatedLoadingIndicator%22).style.getPropertyValue(%22display%22)%20!%3D%20%22none%22)%3B%0A%20%20%7D%0A%0A%20%20await%20wait(10000)%3B%0A%0A%20%20clearTimeout(scrollIntervalId)%3B%0A%20%20%0A%20%20const%20users%20%3D%20Array.from(document.querySelectorAll(%22.rosterUser%22))%0A%20%20%20%20.filter((elm)%3D%3E%7B%20%2F%2FFilter%20out%20inactive%20people%20(people%20who%20drop%20the%20class%20I%20think)%0A%20%20%20%20%20%20let%20labels%20%3D%20elm.querySelectorAll(%22span.label%22)%3B%0A%20%20%20%20%20%20for(let%20label%20of%20labels)%7B%0A%20%20%20%20%20%20%20%20if(label.textContent.includes(%22inactive%22))%7B%0A%20%20%20%20%20%20%20%20%20%20return%20false%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20return%20true%3B%0A%20%20%20%20%7D).map((person)%3D%3E%7B%0A%20%20%20%20return%20%7B%22name%22%3A%20person.querySelector(%22.roster_user_name%22).textContent.trim()%2C%0A%20%20%20%20%20%20%22role%22%3A%20person.children%5B3%5D.textContent.trim()%0A%20%20%20%20%7D%3B%0A%20%20%7D)%3B%0A%20%20%0A%20%20%2F%2F%20Step%201%3A%20Filter%20names%20where%20role%20is%20%22Student%22%20and%20remove%20pronouns%0A%20%20const%20studentList%20%3D%20users%0A%20%20%20%20%2F%2F.filter(user%20%3D%3E%20user.role%20%3D%3D%3D%20%22Student%22)%09Fixed%20that%20by%20selecting%20Students%20with%20the%20input%0A%20%20%20%20.map(user%20%3D%3E%20user.name.replace(%2F(%5C(.%2B%5C))%2Fg%2C%20%22%22).trim())%0A%20%20%20%20.sort()%3B%0A%20%20%0A%20%20%2F%2F%20Step%202%3A%20Identify%20and%20handle%20duplicates%0A%20%20%2F%2FThis%20is%20simplified%20to%20looking%20at%20pairs%20of%20adjacent%20names%20because%20I%20sorted%20the%20list%0A%20%20const%20duplicates%20%3D%20%5B%5D%3B%0A%20%20for%20(let%20i%20%3D%200%3B%20i%20%3C%20(studentList.length%20-%201)%3B%20i%2B%2B)%20%7B%0A%20%20%2F%2Ffor%20(let%20j%20%3D%20i%20%2B%201%3B%20j%20%3C%20studentList.length%3B%20j%2B%2B)%20%7B%0A%20%20%20%20let%20j%20%3D%20i%20%2B%201%3B%0A%20%20%20%20if%20(studentList%5Bi%5D%20%3D%3D%3D%20studentList%5Bj%5D)%20%7B%0A%20%20%20%20%20%20duplicates.push(studentList%5Bi%5D)%3B%0A%20%20%20%20%20%20studentList.splice(j%2C%201)%3B%0A%20%20%20%20%7D%0A%20%20%7D%0A%20%20function%20copyString(text)%7B%0A%09async%20function%20navigatorClipboardCopy(text)%7B%0A%09%09%09if(document.location.protocol%20!%3D%20%22https%3A%22)%7B%0A%09%09%09%09%09return%20false%3B%0A%09%09%09%7D%0A%09%09%09return%20new%20Promise((resolve%2C%20reject)%3D%3E%7B%0A%09%09%09%09%09navigator.clipboard.writeText(text).then(()%3D%3E%7Bresolve(true)%3B%7D%2C%20()%3D%3E%7Bresolve(false)%3B%7D)%3B%0A%09%09%09%7D)%3B%0A%09%7D%0A%09function%20domCopy(text)%7B%0A%09%09%09if(!(document.execCommand))%7B%0A%09%09%09%09%09console.warn(%22They%20finally%20deprecated%20document.execCommand!%22)%3B%0A%09%09%09%7D%0A%0A%09%09%09const%20input%20%3D%20document.createElement('textarea')%3B%0A%09%09%09input.value%20%3D%20text%3B%0A%09%09%09document.body.appendChild(input)%3B%0A%09%09%09input.select()%3B%0A%09%09%09const%20success%20%3D%20document.execCommand('copy')%3B%0A%09%09%09document.body.removeChild(input)%3B%0A%0A%09%09%09return%20success%3B%0A%09%7D%0A%09function%20promptCopy()%7B%0A%09%09%09prompt(%22Copy%20failed.%20Might%20have%20...%20somewhere.%20Check%20console.%22%2C%20text)%3B%0A%09%7D%0A%09function%20done()%7B%0A%09%09%09alert(%22Copied%20to%20clipboard%22)%3B%0A%09%7D%0A%09navigatorClipboardCopy(text).catch(()%3D%3E%7Breturn%20false%3B%7D).then((success)%3D%3E%7B%0A%09%09%09if(success)%7B%0A%09%09%09%09%09done()%3B%0A%09%09%09%7Delse%7B%0A%09%09%09%09%09if(domCopy(text))%7B%0A%09%09%09%09%09%09%09done()%3B%0A%09%09%09%09%09%7Delse%7B%0A%09%09%09%09%09%09%09promptCopy()%3B%0A%09%09%09%09%09%7D%0A%09%09%09%7D%0A%09%7D)%3B%0A%7D%0A%20%20%0A%20%20%2F%2F%20Step%203%3A%20Prompt%20the%20teacher%20with%20the%20final%20list%0A%20%20const%20result%20%3D%20JSON.stringify(studentList)%3B%0A%20%20%0A%20%20if%20(duplicates.length%20%3E%200)%20%7B%0A%20%20%20%20alert(%22Duplicates%20found%3A%20%22%20%2B%20JSON.stringify(duplicates))%3B%0A%20%20%7D%20else%20%7B%0A%20%20%20%20copyString(result)%3B%0A%20%20%7D%0A%20%20%0A%20%20console.log(result)%3B%0A%7D)()%3B%7D)()%3B">CanvasClassList</a><br />
			<a href="javascript:(function()%7B(async%20function()%7B%0A%20%20%20%20const%20TEST%20%3D%20false%3B%0A%20%20%20%20const%20COMMENT%20%3D%20false%3B%20%2F%2FDon't%20actually%20click%20the%20submit%20button%0A%20%20%20%20const%20CARE_IF_GRADED%20%3D%20false%3B%0A%20%20%20%20const%20version%20%3D%20%22v0.8%22%3B%0A%0A%20%20%20%20if(!(document.getElementById(%22comment_submit_button%22)))%7B%0A%20%20%20%20%20%20%20%20alert(%22You%20need%20to%20be%20on%20the%20canvas%20SpeedGrader%E2%84%A2%20page%20for%20this%20to%20work.%22)%3B%0A%20%20%20%20%20%20%20%20return%3B%0A%20%20%20%20%7D%0A%20%20%20%20%0A%20%20%20%20const%20listText%20%3D%20prompt(%22Enter%20the%20present%20JSON%20list%22)%3B%0A%20%20%20%20if(!listText)%20return%3B%0A%20%20%20%20try%7B%0A%20%20%20%20%20%20%20%20const%20presentList%20%3D%20JSON.parse(listText)%3B%0A%20%20%20%20%7Dcatch(e)%7B%0A%20%20%20%20%20%20%20%20alert(%22Couldn't%20parse%20list%3A%20%22%20%2B%20e.message)%3B%0A%20%20%20%20%20%20%20%20return%3B%0A%20%20%20%20%7D%0A%20%20%20%20const%20presentList%20%3D%20JSON.parse(listText)%3B%0A%20%20%20%20%0A%20%20%20%20let%20maxGrade%20%3D%20%22100%22%3B%0A%20%20%20%20const%20maxGradeElement%20%3D%20document.getElementById(%22grading-box-points-possible%22)%3B%0A%20%20%20%20if(!maxGradeElement)%7B%0A%20%20%20%20%20%20%20%20if(!confirm(%22Max%20grade%20not%20found.%20Defaulting%20to%20100%22))%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%2F%2FIf%20the%20user%20hits%20cancel%0A%20%20%20%20%20%20%20%20%20%20%20%20return%3B%20%2F%2FQuit%20the%20program%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%7Delse%7B%0A%20%20%20%20%20%20%20%20const%20maxGradeText%20%3D%20maxGradeElement.textContent.trim()%3B%0A%20%20%20%20%20%20%20%20const%20outOfIndex%20%3D%20maxGradeText.indexOf(%22out%20of%20%22)%3B%0A%20%20%20%20%20%20%20%20if(outOfIndex%20%3C%200)%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20if(!confirm(%22Max%20grade%20not%20found.%20Defaulting%20to%20100%22))%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%2F%2FIf%20the%20user%20hits%20cancel%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20return%3B%20%2F%2FQuit%20the%20program%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20maxGrade%20%3D%20maxGradeText.substr(outOfIndex%20%2B%20(%22out%20of%20%22).length)%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20async%20function%20wait(ms)%7B%0A%20%20%20%20%20%20%20%20return%20new%20Promise((resolve%2C%20reject)%3D%3E%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20setTimeout(resolve%2C%20ms)%3B%0A%20%20%20%20%20%20%20%20%7D)%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20const%20studentSelectMenu%20%3D%20document.getElementById(%22students_selectmenu%22)%3B%0A%20%20%20%20for(let%20student%20of%20presentList)%7B%0A%20%20%20%20%20%20%20%20let%20found%20%3D%20false%3B%0A%20%20%20%20%20%20%20%20for(let%20option%20of%20Array.from(studentSelectMenu.querySelectorAll(%22option%22)))%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20const%20optionText%20%3D%20option.textContent.trim()%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20if(optionText.includes(student))%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20found%20%3D%20true%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if((!CARE_IF_GRADED)%20%7C%7C%20option.classList.contains(%22not_graded%22))%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20option.selected%20%3D%20true%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20studentSelectMenu.dispatchEvent(new%20Event('change'))%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20studentSelectMenu.dispatchEvent(new%20Event('input'))%3B%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20await%20wait(300)%3B%0A%20%20%20%20%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%2F%2FDouble%20check%20to%20make%20sure%20we%20are%20grading%20the%20right%20student%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20const%20nameElement%20%3D%20document.getElementById(%22students_selectmenu-button%22)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20const%20name%20%3D%20nameElement.textContent.trim()%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if(!(name.includes(student)))%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20alert(%22Something%20might%20have%20messed%20up%20with%20this%20student%3A%20%22%20%2B%20student)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7Delse%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20const%20gradingBox%20%3D%20document.getElementById(%22grading-box-extended%22)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if(!gradingBox)%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20alert(%22The%20grading%20box%20doesn't%20exist!%20How%20is%20that%20possible%3F%22)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20return%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if(!TEST)%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20gradingBox.value%20%3D%20maxGrade%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20gradingBox.dispatchEvent(new%20Event('change'))%3B%20%2F%2FThis%20grades%20it%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if(COMMENT)%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20const%20commentElement%20%3D%20document.getElementById(%22speed_grader_comment_textarea%22)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20commentElement.value%20%2B%3D%20%22Graded%20using%20AttendanceTaker's%20speed%20grader%20autograder%20version%20%22%20%2B%20version%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20commentElement.dispatchEvent(new%20Event('change'))%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20commentElement.dispatchEvent(new%20Event('input'))%3B%0A%20%20%20%20%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20const%20submitButton%20%3D%20document.getElementById(%22comment_submit_button%22)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if(!submitButton)%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20alert(%22The%20submit%20button%20is%20gone!%22)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20return%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if(!test)%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20submitButton.click()%3B%20%2F%2F.click%20might%20not%20work%20here%2C%20and%20we%20might%20have%20to%20use%20.dispatchEvent(new%20Event('click'))%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20await%20wait(500)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20if(!found)%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20alert(%22Student%20not%20found%3A%20%22%20%2B%20student)%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%20%20alert(%22Done%20grading.%22)%3B%0A%7D)()%3B%7D)()%3B">GradeClassList</a>
		</div>
			<div class="left_div_para">
				<p>You need to be on the canvas SpeedGrader page in order for it to work. The spellings of the names needs to be the same spellings that are in Canvas so if you use the CanvasClassList bookmarklet, you should be fine.</p>
			</div>
		</div>
			<div class="right_div">
			<form class="input_form" method="post"> <!-- Posts to the same url as the home page -->
				{% csrf_token %}
				{{ form }}
				<button class="create_room" type="submit">{{ submitText }}</button>
			</form>
		    </div>
</div>
